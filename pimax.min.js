function byteConversion(i){var a,e;return null==i||""==i||"undefined"==i?"? KB":i>=1024?(a=i/1024,a>=1024?(e=a/1024,e.toFixed(2)+" MB"):a.toFixed(2)+" KB"):i+" bytes"}function getDateDiff(i){var a,e,t,o,p,l,s,m;return null==i||""==i||"undefined"==i?"?":(a=i.toString().split("T")[0].split("-"),e=new Date,t=e.getFullYear(),o=parseInt(a[0],10),p=e.getMonth(),l=parseInt(a[1],10),s=p+12*t-(l+12*o),1>=s?"1 month":12>s?s+" months":(m=Math.floor(s/12),1>=m?"1 year":12>m?m+" years":void 0))}function loadPimax(){$("#pimax").append('<div id="pimax-header"><div id="pimax-stat-holder"></div></div>'),$("#pimax").append('<div id="pimax-tabs"></div>'),createPimaxTabs(),$("#pimax").append('<div id="pimax-encloser"><div id="pimax-img-list-div"></div></div>'),$("#pimax-img").hide(),$("#pimax").append('<div id="pimax-lightbox"><div id="picasa-lightbox-wrapper"><div id="picasa-lightbox-image"><img id="picasa-img-lightbox" src=""></div><div id="picasa-lightbox-helper"></div></div></div>'),$("#pimax-lightbox").click(function(){$("#picasa-img-lightbox").attr("src",""),$("#pimax-lightbox").hide()}),$("#picasa-img-lightbox").click(function(){var i=$(".pimax-selected").next();return(null==i||"undefined"==i||""==i.text())&&(i=$(".pimax-img-tnail-box:first")),$(".pimax-selected").removeClass("pimax-selected"),i.addClass("pimax-selected"),showVideoLightbox(i.attr("data-picSrc")),!1}),$("#pimax-lightbox").hide()}function showLoadingInLightbox(){$("#picasa-img-lightbox").attr("src",""),$("#picasa-img-lightbox").attr("src",pathToLoadingImage)}function preparePimax(){-1!=googleUserName.indexOf("@")?googleUserName=googleUserName.substring(0,googleUserName.indexOf("@")):-1!=googleUserName.indexOf("plus.google.com/")&&(googleUserName=googleUserName.substring(googleUserName.indexOf("plus.google.com/")+16),-1!=googleUserName.indexOf("/")&&(googleUserName=googleUserName.substring(0,googleUserName.indexOf("/")))),$("#pimax").empty(),loadPimax(),showLoader()}function setHeader(i){i&&i.overrideMimeType&&i.overrideMimeType("application/j-son;charset=UTF-8")}function showLoader(){$("#pimax-img-list-div").empty(),$("#pimax-img").hide(),$("#pimax-img").attr("src",""),$("#pimax-img-list-div").append('<div style="text-align:center; height:200px; font:14px Calibri;"><br><br><br><br><br><br>loading...</div>')}function getAlbums(){showLoader();var i="https://picasaweb.google.com/data/feed/api/user/"+googleUserName+"?alt=json-in-script";$.ajax({url:i,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(i){showAlbums(i)},error:function(i){alert(i)},beforeSend:setHeader})}function createPimaxTabs(){var i="https://picasaweb.google.com/data/feed/api/user/"+googleUserName+"?alt=json-in-script";$.ajax({url:i,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(i){showPimaxTabs(i)},error:function(i){alert(i)},beforeSend:setHeader})}function showPimaxTabs(i){var a,e,t,o,p;for(console.log(i),a=i.feed.entry,e=0,t=[],showPimaxHeader(i),o=0;o<albumNames.length;o++)for(p=0;p<a.length;p++)if(albumTitle=a[p].media$group.media$title.$t,albumTitle.toUpperCase()===albumNames[o].toUpperCase()){albumId=a[p].gphoto$id.$t,$("#pimax-tabs").append('<span id="'+albumId+'" class="pimax-tab">'+albumTitle+"</span>");break}$("#pimax-tabs").append('<span id="picasa-albums" class="pimax-tab">Albums</span>'),$(".pimax-tab").click(function(){$(".pimax-tab").css("color","#666"),$(".pimax-tab").css("background-color","rgb(230,230,230)"),$(".pimax-tab").css("text-shadow","0 1px 0 #fff"),$(this).css("color","#eee"),$(this).css("background-color","#999"),$(this).css("text-shadow","0 0"),pimaxTabId=this.id,"picasa-albums"==pimaxTabId?getAlbums():getAlbumImages(pimaxTabId)}),$(".pimax-tab:first").click()}function showPimaxHeader(i){var a=i.feed.author[0].name.$t,e=i.feed.author[0].uri.$t,t=i.feed.gphoto$thumbnail.$t;$("#pimax-header").append('<a target="_blank" href="'+e+'"><img style="vertical-align:middle; height:60px; margin:15px; display:inline-block;" src="'+t+'"/>'+a+"</a>")}function showAlbums(i){var a,e,t,o,p,l,s;for(console.log(i),$("#pimax-img-list-div").empty(),a=i.feed.entry,e=0,t=[],p=0;p<a.length;p++)albumId=a[p].gphoto$id.$t,numPics=a[p].gphoto$numphotos.$t,albumType=a[p].gphoto$albumType,null!=albumType&&"undefined"!=albumType&&(albumType=albumType.$t),picThumbnail=a[p].media$group.media$thumbnail[0].url,picThumbnail=picThumbnail.replace("s160-c","s300-c"),picTitle=a[p].media$group.media$title.$t,albumUploaded=a[p].published.$t,"Buzz"!=albumType?(t.push(albumId),(p-e)%pimaxColumns!=0?$("#pimax-img-list-div").append('<div class="pimax-img-tnail-box" style="width:'+(100/pimaxColumns-4)+'%;" id="'+albumId+'"><div class="pimax-img-tnail" style="background-image:url(\''+picThumbnail+'\')"><div class="pimax-album-sidebar" id="pimax-album-sidebar-'+albumId+'"><span class="pimax-album-img-count"><b>'+numPics+'</b><br/>PHOTOS</span></div></div><span class="pimax-img-list-title">'+picTitle+'</span><br/><span class="pimax-img-list-views">'+numPics+" photos | "+getDateDiff(albumUploaded)+" ago</span></div>"):$("#pimax-img-list-div").append('<div class="pimax-img-tnail-box" style="width:'+(100/pimaxColumns-4)+'%; clear:both;" id="'+albumId+'"><div class="pimax-img-tnail" style="background-image:url(\''+picThumbnail+'\')"><div class="pimax-album-sidebar" id="pimax-album-sidebar-'+albumId+'"><span class="pimax-album-img-count"><b>'+numPics+'</b><br/>PHOTOS</span></div></div><span class="pimax-img-list-title">'+picTitle+'</span><br/><span class="pimax-img-list-views">'+numPics+" photos | "+getDateDiff(albumUploaded)+" ago</span></div>")):e++;$(".pimax-img-tnail-box").click(function(){getAlbumImages(this.id)}),l=$(".pimax-img-tnail").css("width"),l=l.substring(0,l.indexOf("px")),s=l/pimaxImageAspectRatio,$("div.pimax-img-tnail").css({height:s+"px"}),130>s?(o=3,$("html > head").append("<style>.pimax-album-img-count{margin: 10%;margin-top: 15%;}.pimax-album-sidebar-img{margin: 8% auto;}</style>")):o=4}function getAlbumImages(i){showLoader(),apiPlaylistVideosURL="https://picasaweb.google.com/data/feed/api/user/"+googleUserName+"/albumid/"+i+"?alt=json-in-script",$.ajax({url:apiPlaylistVideosURL,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(i){showAlbumImages(i)},error:function(i){alert(i)},beforeSend:setHeader})}function showAlbumImages(i){var a,e,t,o;for(console.log(i),$("#pimax-img-list-div").empty(),$("#pimax-img-list-div").append('<span class="pimax-img-list-title" style="max-width:100%;"><span class="pimax-showing">&nbsp;&nbsp;Showing album: </span>'+i.feed.gphoto$name.$t+"</span><br/>"),a=i.feed.entry,e=0;e<a.length;e++)picId=a[e].gphoto$id.$t,picThumbnail=a[e].media$group.media$thumbnail[0].url,picThumbnail=picThumbnail.replace("s72","s300-c"),picTitle=a[e].media$group.media$title.$t,picUploaded=a[e].published.$t,picSrc=picThumbnail.replace("s300-c","s1600"),picHeight=a[e].media$group.media$content[0].height,picWidth=a[e].media$group.media$content[0].width,resolution=picWidth+" x "+picHeight,picSize=a[e].gphoto$size.$t,e%pimaxColumns!=0?$("#pimax-img-list-div").append('<div class="pimax-img-tnail-box" style="width:'+(100/pimaxColumns-4)+'%;" data-picSrc="'+picSrc+'" data-picHeight="'+picHeight+'" id="'+picId+'"><div class="pimax-img-tnail" style="background-image:url(\''+picThumbnail+'\')"><div class="pimax-img-size">'+byteConversion(picSize)+'</div></div><span class="pimax-img-list-title">'+picTitle+'</span><br/><span class="pimax-img-list-views">'+resolution+" | "+getDateDiff(picUploaded)+" ago</span></div>"):$("#pimax-img-list-div").append('<div class="pimax-img-tnail-box" style="width:'+(100/pimaxColumns-4)+'%; clear:both;" data-picSrc="'+picSrc+'" data-picHeight="'+picHeight+'" id="'+picId+'"><div class="pimax-img-tnail" style="background-image:url(\''+picThumbnail+'\')"><div class="pimax-img-size">'+byteConversion(picSize)+'</div></div><span class="pimax-img-list-title">'+picTitle+'</span><br/><span class="pimax-img-list-views">'+resolution+" | "+getDateDiff(picUploaded)+" ago</span></div>");$(".pimax-img-tnail-box").click(function(){$(".pimax-img-tnail-box").removeClass("pimax-selected"),$(this).addClass("pimax-selected"),showVideoLightbox(this.getAttribute("data-picSrc"))}),t=$(".pimax-img-tnail").css("width"),t=t.substring(0,t.indexOf("px")),o=t/pimaxImageAspectRatio,$("div.pimax-img-tnail").css({height:o+"px"})}function showVideoLightbox(i){$("#pimax-lightbox").show(),showLoadingInLightbox(),setTimeout(function(){$("#picasa-img-lightbox").attr("src",i)},10)}var pimaxColumns,pimaxWidgetWidth,albumNames,pathToLoadingImage,pimaxImageAspectRatio;(null==pimaxColumns||""==pimaxColumns||"undefined"==pimaxColumns)&&(pimaxColumns=2),(null==pimaxWidgetWidth||""==pimaxWidgetWidth||"undefined"==pimaxWidgetWidth)&&(pimaxWidgetWidth=640),(null==albumNames||""==albumNames||"undefined"==albumNames)&&(albumNames=[]),(null==pathToLoadingImage||""==pathToLoadingImage||"undefined"==pathToLoadingImage)&&(pathToLoadingImage=""),"undefined"!=typeof pimaxWidgetHeight&&null!=pimaxWidgetHeight&&""!=pimaxWidgetHeight&&"undefined"!=pimaxWidgetHeight&&$("html > head").append("<style>#pimax{overflow-y:auto;height:"+pimaxWidgetHeight+"px;}</style>"),pimaxImageAspectRatio=1,$(document).ready(function(){var i="<style>.pimax-showing {color:black;font-weight:normal;}.pimax-img-size {background-color: black;color: white;padding: 2px 3px;font-weight: bold;position: absolute;bottom: 0;right: 0;opacity: 0.8;}#pimax-header {background-color:rgb(53,53,53);font:24px Arial;color:white;line-height:25px;height:90px;text-align:left;border: 1px solid rgb(53,53,53);}.pimax-stat {float:right;margin:10px;font:10px Arial;color:#ccc;margin-top: 25px;text-align: center;}#pimax-stat-holder {float:right;height:100%;}.pimax-stat-count {font: 18px Arial;}#pimax-channel-desc {text-align:left;}#pimax {width:"+pimaxWidgetWidth+"px;background-color: rgb(230,230,230);margin:0px auto;font-family: Calibri;font-size: 14px;text-align:center; overflow-x:hidden;}.pimax-img-tnail {width:100%; background-repeat:no-repeat; background-size:100%;height:180px;position: relative;}.pimax-img-tnail-box {background-color: white;width:46%;margin:2%;float:left;overflow:hidden;box-shadow:inset 0 1px 0 rgba(255, 255, 255, 0.25), 0 1px 3px rgba(0, 0, 0, 0.2);cursor:pointer;cursor:hand;}#pimax-encloser {border-left: 1px solid #cccccc;border-right: 1px solid #cccccc;border-bottom: 1px solid #cccccc;}#pimax-img-list-div {width:100%;text-align:left;display: inline-block;background-color:rgb(230,230,230);	}.pimax-img-list-title {color:#438bc5;display: inline-block;padding:2% 10px; padding-bottom: 0px;font-weight:bold;max-width:250px;max-height:18px;overflow:hidden;}.pimax-img-list-views {color:#555;padding:1% 10px; padding-bottom: 3%;display:inline-block;font-size:12px;}.pimax-album-sidebar {width: 70px;background-color:rgba(0,0,0,0.8);float:right;max-width:50%;height:100%;color:white;text-align:center;}.pimax-album-img-count {	display:inline-block;margin-top:105px;height:20%;width: 100%;}.pimax-album-sidebar-img {opacity:1;width:64px;height:20%;background-color:rgb(114,114,114);display:inline-block;margin:2% auto;background-size:cover;background-position: center center;background-repeat:no-repeat;}.pimax-tab {background-color:rgb(230,230,230);color:#666;text-shadow:0 1px 0 #fff;display: inline-block;margin: 5px;margin-top: 10px;padding: 5px;cursor:pointer;cursor:hand;}#pimax-tabs {text-align:left;background-color:rgb(230,230,230);padding-left: 10px;border-left: 1px solid #cccccc;border-right: 1px solid #cccccc;}#pimax-lightbox {position:fixed;background-color:rgba(0,0,0,0.9);z-index:100;width:100%;height:100%;left:0;top:0;}#picasa-img-lightbox {opacity:1; max-width:1000px; max-height:700px; z-index:200;cursor:pointer;cursor:mouse;}#picasa-lightbox-wrapper {height: 100%;width: 100%;white-space: nowrap;}#picasa-lightbox-image {display: inline-block;vertical-align: middle;white-space: normal;z-index:120;}#picasa-lightbox-helper {display: inline-block;vertical-align: middle;height: 100%;}#pimax-header a {text-decoration: none;color: inherit;}</style>";$("html > head").append(i),preparePimax()});